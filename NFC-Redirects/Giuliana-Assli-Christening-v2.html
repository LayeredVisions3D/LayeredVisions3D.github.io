<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Giuliana & Assli Christening – Redirect</title>

  <!-- Cache busting hints (some CDNs may still cache; use ?v=N or rename file if needed) -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <meta name="robots" content="noindex" />
  <style>
    :root { --muted:#6b7280; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 24px; line-height: 1.5; }
    .card { max-width: 760px; margin: 6vh auto; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; }
    .btn { display: inline-block; padding: 10px 16px; text-decoration: none; border: 1px solid #1f2937; border-radius: 8px; }
    .muted { color: var(--muted); font-size: .92em; }
    .banner { background: #fffbe6; border: 1px solid #f59e0b; padding: 12px 16px; border-radius: 8px; margin-bottom: 16px; }
    code { background:#f6f8fa; padding:2px 6px; border-radius:6px; }
    .kv { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 0.95em; }
  </style>
</head>
<body>
  <div class="card">
    <div class="banner" id="info">Checking time…</div>
    <h1>Christening Photos</h1>
    <p id="status">Taking you to the right place…</p>
    <p><a id="fallback" class="btn" href="#" rel="noopener">Open link</a></p>
    <p class="muted">If you’re not redirected automatically, tap “Open link.”</p>
    <hr>
    <details>
      <summary>Debug details</summary>
      <div id="debug" class="muted kv" style="white-space:pre-wrap"></div>
      <p class="muted">
        Manual override: <code>?to=guestcam</code> or <code>?to=drive</code><br>
        Debug mode (no auto-redirect): <code>?mode=debug</code><br>
        Cache-bust after pushes: add <code>?v=2</code> (increment each time)
      </p>
    </details>
  </div>

  <script>
    // ====== EDIT THESE LINES ======
    const guestcamURL = "https://guestcam.co/your-event-code"; // TODO: put your real Guestcam link
    const driveURL    = "https://drive.google.com/drive/folders/your-folder-id?usp=sharing"; // TODO: your real Drive folder
    // UTC cutoff (Z means UTC). Example shown below.
    const cutoffUTC   = "2025-09-21T14:45:00Z";
    // =================================

    const qs = new URLSearchParams(location.search);
    const override = (qs.get("to") || "").toLowerCase();
    const debugMode = (qs.get("mode") || "").toLowerCase() === "debug";

    const now = new Date();
    const cutoff = new Date(cutoffUTC);

    let target = guestcamURL;
    if (override === "guestcam") target = guestcamURL;
    else if (override === "drive") target = driveURL;
    else if (now >= cutoff) target = driveURL;

    // Visible info banner
    const info = document.getElementById("info");
    info.textContent = "Now: " + now.toISOString() + " | Cutoff: " + cutoff.toISOString() + " | Target: " + (target === guestcamURL ? "Guestcam" : "Google Drive") + (debugMode ? " (debug mode: no auto-redirect)" : "");

    // Update UI
    document.getElementById("fallback").href = target;
    document.getElementById("status").textContent = "Redirecting to: " + (target === guestcamURL ? "Guestcam" : "Google Drive");

    // Debug block
    (function(){
      const dbg = document.getElementById("debug");
      const lines = [];
      lines.push("Now (client): " + now.toISOString());
      lines.push("Cutoff (UTC): " + cutoff.toISOString());
      lines.push("Override:     " + (override || "none"));
      lines.push("Decision:     " + (now >= cutoff ? "AFTER cutoff → Drive" : "BEFORE cutoff → Guestcam"));
      lines.push("Target URL:   " + target);
      lines.push("Debug mode:   " + (debugMode ? "ON (no auto-redirect)" : "OFF"));
      dbg.textContent = lines.join("\n");
      console.log(lines.join("\n"));
    })();

    // Auto-redirect: only if not in debug mode. Delay a bit so you can read the banner.
    if (!debugMode) {
      setTimeout(function(){
        try { location.replace(target); } catch(e) { location.href = target; }
      }, 2000);
    }
  </script>
</body>
</html>
